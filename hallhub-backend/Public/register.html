<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>HallHub - Student Registration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Enable dark mode via class -->
    <script>
        tailwind.config = { darkMode: 'class' };

        // Apply saved theme before rendering
        if (localStorage.theme === 'dark') {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark'); // default: light
        }
    </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 font-sans min-h-screen flex flex-col transition-colors duration-300">

    <!-- Header Section -->
    <header class="bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-indigo-700 dark:to-purple-900 text-white py-6 shadow-lg">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <h1 class="text-3xl font-bold">üè¢ HallHub</h1>
            <nav class="flex items-center space-x-4">
                <a href="home.html" class="mx-4 hover:text-gray-200 dark:hover:text-gray-300 transition">Back to Home</a>
                <a href="login.html" class="mx-4 hover:text-gray-200 dark:hover:text-gray-300 transition">Login</a>
                <!-- Theme Toggle Button -->
                <button id="theme-toggle" class="px-3 py-1 bg-white/20 rounded hover:bg-white/30 transition select-none">
                    üåô
                </button>
            </nav>
        </div>
    </header>

    <!-- Success/Error Message -->
    <div id="alert-message" class="hidden">
        <div class="container mx-auto px-4 py-3">
            <div id="alert-content" class="p-4 rounded-lg shadow-md">
                <p id="alert-text"></p>
            </div>
        </div>
    </div>

    <!-- Registration Form Section -->
    <section class="flex-grow py-12">
        <div class="container mx-auto px-4">
            <div class="max-w-md mx-auto 
                        bg-white/20 dark:bg-gray-800/30 
                        backdrop-blur-lg border border-white/20 dark:border-gray-700/30 
                        rounded-xl shadow-lg p-8 
                        hover:shadow-[0_0_25px_rgba(0,255,255,0.8)] transition
                        hover:scale-[1.01] transform duration-300 ease-in-out">
                <h2 class="text-3xl font-bold text-gray-800 dark:text-white text-center mb-6">üéì Student Registration</h2>
                
                <form id="registration-form" class="space-y-4" novalidate>
                    <div>
                        <label for="student-id" class="block text-gray-700 dark:text-gray-300 font-semibold">Student ID *</label>
                        <input type="text" id="student-id" name="student-id" autocomplete="off" required
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors" />
                        <span class="text-red-500 text-sm hidden" id="student-id-error"></span>
                    </div>
                    
                    <div>
                        <label for="name" class="block text-gray-700 dark:text-gray-300 font-semibold">Full Name *</label>
                        <input type="text" id="name" name="name" autocomplete="off" required
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors" />
                        <span class="text-red-500 text-sm hidden" id="name-error"></span>
                    </div>
                    
                    <div>
                        <label for="email" class="block text-gray-700 dark:text-gray-300 font-semibold">Email Address *</label>
                        <input type="email" id="email" name="email" autocomplete="off" required
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors" />
                        <span class="text-red-500 text-sm hidden" id="email-error"></span>
                    </div>
                    
                    <div>
                        <label for="department" class="block text-gray-700 dark:text-gray-300 font-semibold">Department</label>
                        <input type="text" id="department" name="department" autocomplete="off"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors" />
                    </div>
                    
                    <div>
                        <label for="level" class="block text-gray-700 dark:text-gray-300 font-semibold">Level</label>
                        <input type="text" id="level" name="level" autocomplete="off"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors" />
                    </div>
                    
                    <div>
                        <label for="address" class="block text-gray-700 dark:text-gray-300 font-semibold">Address</label>
                        <textarea id="address" name="address" rows="2" autocomplete="off"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors resize-none"></textarea>
                    </div>
                    
                    <div>
                        <label for="phone" class="block text-gray-700 dark:text-gray-300 font-semibold">Phone Number</label>
                        <input type="tel" id="phone" name="phone" autocomplete="off"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors" />
                        <span class="text-red-500 text-sm hidden" id="phone-error"></span>
                    </div>
                    
                    <div>
                        <label for="relativename" class="block text-gray-700 dark:text-gray-300 font-semibold">Relative Name</label>
                        <input type="text" id="relativename" name="relativename" autocomplete="off"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors" />
                    </div>
                    
                    <div>
                        <label for="relativerelation" class="block text-gray-700 dark:text-gray-300 font-semibold">Relative Relation</label>
                        <select id="relativerelation" name="relativerelation"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors">
                            <option value="">Select Relation</option>
                            <option value="Father">Father</option>
                            <option value="Mother">Mother</option>
                            <option value="Guardian">Guardian</option>
                            <option value="Brother">Brother</option>
                            <option value="Sister">Sister</option>
                            <option value="Uncle">Uncle</option>
                            <option value="Aunt">Aunt</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="relativeaddress" class="block text-gray-700 dark:text-gray-300 font-semibold">Relative Address</label>
                        <textarea id="relativeaddress" name="relativeaddress" rows="2" autocomplete="off"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors resize-none"></textarea>
                    </div>
                    
                    <div>
                        <label for="relativephone" class="block text-gray-700 dark:text-gray-300 font-semibold">Relative Phone Number</label>
                        <input type="tel" id="relativephone" name="relativephone" autocomplete="off"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors" />
                        <span class="text-red-500 text-sm hidden" id="relativephone-error"></span>
                    </div>
                    
                    <div>
                        <label for="password" class="block text-gray-700 dark:text-gray-300 font-semibold">Password *</label>
                        <input type="password" id="password" name="password" autocomplete="off" required
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors" />
                        <span class="text-red-500 text-sm hidden" id="password-error"></span>
                        <small class="text-gray-500 dark:text-gray-400">Password must be at least 6 characters long</small>
                    </div>
                    
                    <div>
                        <label for="confirm-password" class="block text-gray-700 dark:text-gray-300 font-semibold">Confirm Password *</label>
                        <input type="password" id="confirm-password" name="confirm-password" autocomplete="off" required
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 
                                   dark:bg-gray-700 dark:text-white dark:border-gray-600 transition-colors" />
                        <span class="text-red-500 text-sm hidden" id="confirm-password-error"></span>
                    </div>

                    <button type="submit" id="submit-btn"
                        class="w-full 
                               bg-gradient-to-r from-blue-500 to-indigo-600 
                               hover:from-cyan-400 hover:to-blue-700
                               hover:scale-[1.03] transform duration-300 ease-in-out
                               text-white py-3 rounded-lg 
                               shadow-[0_0_15px_rgba(0,255,255,0.6)] hover:shadow-[0_0_25px_rgba(0,255,255,0.9)] 
                               transition font-semibold disabled:opacity-50 disabled:cursor-not-allowed">
                        <span id="submit-text">Register Now</span>
                        <span id="loading-spinner" class="hidden">
                            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            Registering...
                        </span>
                    </button>
                    
                    <div class="text-center mt-4">
                        <p class="text-gray-600 dark:text-gray-400">Already have an account? 
                            <a href="login.html" class="text-blue-600 dark:text-blue-400 hover:underline font-semibold">Login here</a>
                        </p>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer Section -->
    <footer class="bg-gray-800 dark:bg-gradient-to-t dark:from-gray-900 dark:to-gray-800 text-white py-6 border-t border-gray-700">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-4 text-gray-300">¬© 2025 HallHub. All rights reserved.</p>
            <div class="flex justify-center space-x-4">
                <a href="#contact" class="hover:text-gray-200 dark:hover:text-gray-400 transition">Contact Us</a>
                <a href="#privacy" class="hover:text-gray-200 dark:hover:text-gray-400 transition">Privacy Policy</a>
                <a href="#terms" class="hover:text-gray-200 dark:hover:text-gray-400 transition">Terms of Service</a>
            </div>
        </div>
    </footer>

    <script>
        // Theme Toggle Logic
        document.getElementById('theme-toggle').addEventListener('click', function () {
            document.documentElement.classList.toggle('dark');
            if (document.documentElement.classList.contains('dark')) {
                localStorage.theme = 'dark';
                this.textContent = '‚òÄÔ∏è';
            } else {
                localStorage.theme = 'light';
                this.textContent = 'üåô';
            }
        });

        // Set button icon on load
        document.getElementById('theme-toggle').textContent =
            document.documentElement.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';

        // Utility functions
        function showAlert(message, type = 'success') {
            const alertMessage = document.getElementById('alert-message');
            const alertContent = document.getElementById('alert-content');
            const alertText = document.getElementById('alert-text');
            
            // Set colors based on type
            if (type === 'success') {
                alertContent.className = 'p-4 rounded-lg shadow-md bg-green-100 dark:bg-green-800 border border-green-400 dark:border-green-600';
                alertText.className = 'text-green-700 dark:text-green-200';
            } else {
                alertContent.className = 'p-4 rounded-lg shadow-md bg-red-100 dark:bg-red-800 border border-red-400 dark:border-red-600';
                alertText.className = 'text-red-700 dark:text-red-200';
            }
            
            alertText.textContent = message;
            alertMessage.classList.remove('hidden');
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                alertMessage.classList.add('hidden');
            }, 5000);
        }

        function showError(fieldId, message) {
            const field = document.getElementById(fieldId);
            const error = document.getElementById(fieldId + '-error');
            
            if (error) {
                error.textContent = message;
                error.classList.remove('hidden');
                field.classList.add('border-red-500', 'focus:ring-red-500');
                field.classList.remove('focus:ring-blue-600');
            }
        }

        function clearError(fieldId) {
            const field = document.getElementById(fieldId);
            const error = document.getElementById(fieldId + '-error');
            
            if (error) {
                error.classList.add('hidden');
                field.classList.remove('border-red-500', 'focus:ring-red-500');
                field.classList.add('focus:ring-blue-600');
            }
        }

        function clearAllErrors() {
            const errorFields = ['student-id', 'name', 'email', 'phone', 'password', 'confirm-password', 'relativephone'];
            errorFields.forEach(fieldId => clearError(fieldId));
        }

        function validateForm(formData) {
            let isValid = true;
            
            // Clear previous errors
            clearAllErrors();
            
            // Validate required fields
            if (!formData.studentId) {
                showError('student-id', 'Student ID is required');
                isValid = false;
            }
            
            if (!formData.name) {
                showError('name', 'Full name is required');
                isValid = false;
            }
            
            if (!formData.email) {
                showError('email', 'Email address is required');
                isValid = false;
            } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(formData.email)) {
                showError('email', 'Please enter a valid email address');
                isValid = false;
            }
            
            // Validate phone number (basic validation)
            if (formData.phone && !/^[\d\+\-\(\)\s]+$/.test(formData.phone)) {
                showError('phone', 'Please enter a valid phone number');
                isValid = false;
            }
            
            if (formData.relativePhone && !/^[\d\+\-\(\)\s]+$/.test(formData.relativePhone)) {
                showError('relativephone', 'Please enter a valid phone number');
                isValid = false;
            }
            
            // Validate password
            if (!formData.password) {
                showError('password', 'Password is required');
                isValid = false;
            } else if (formData.password.length < 6) {
                showError('password', 'Password must be at least 6 characters long');
                isValid = false;
            }
            
            if (!formData.confirmPassword) {
                showError('confirm-password', 'Please confirm your password');
                isValid = false;
            } else if (formData.password !== formData.confirmPassword) {
                showError('confirm-password', 'Passwords do not match');
                isValid = false;
            }
            
            return isValid;
        }

        function setLoading(isLoading) {
            const submitBtn = document.getElementById('submit-btn');
            const submitText = document.getElementById('submit-text');
            const loadingSpinner = document.getElementById('loading-spinner');
            
            if (isLoading) {
                submitBtn.disabled = true;
                submitText.classList.add('hidden');
                loadingSpinner.classList.remove('hidden');
            } else {
                submitBtn.disabled = false;
                submitText.classList.remove('hidden');
                loadingSpinner.classList.add('hidden');
            }
        }

        // Form submission logic
        const form = document.getElementById('registration-form');
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // Collect form data
            const formData = {
                studentId: document.getElementById('student-id').value.trim(),
                name: document.getElementById('name').value.trim(),
                email: document.getElementById('email').value.trim(),
                department: document.getElementById('department').value.trim(),
                level: document.getElementById('level').value.trim(),
                address: document.getElementById('address').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                relativeName: document.getElementById('relativename').value.trim(),
                relativeRelation: document.getElementById('relativerelation').value.trim(),
                relativeAddress: document.getElementById('relativeaddress').value.trim(),
                relativePhone: document.getElementById('relativephone').value.trim(),
                password: document.getElementById('password').value,
                confirmPassword: document.getElementById('confirm-password').value,
            };

            // Validate form
            if (!validateForm(formData)) {
                return;
            }

            setLoading(true);

            try {
                // Send registration request
                const response = await fetch('http://localhost:3000/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),
                });

                const result = await response.json();

                if (response.ok) {
                    showAlert('Registration successful! You can now login with your credentials.', 'success');
                    form.reset();
                    
                    // Redirect to login page after 2 seconds
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 2000);
                } else {
                    showAlert(result.error || 'Registration failed. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Registration error:', error);
                showAlert('Failed to connect to the server. Please try again later.', 'error');
            } finally {
                setLoading(false);
            }
        });

        // Real-time validation on input change
        document.getElementById('email').addEventListener('blur', function() {
            if (this.value && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.value)) {
                showError('email', 'Please enter a valid email address');
            } else {
                clearError('email');
            }
        });

        document.getElementById('password').addEventListener('input', function() {
            if (this.value && this.value.length < 6) {
                showError('password', 'Password must be at least 6 characters long');
            } else {
                clearError('password');
            }
        });

        document.getElementById('confirm-password').addEventListener('input', function() {
            const password = document.getElementById('password').value;
            if (this.value && this.value !== password) {
                showError('confirm-password', 'Passwords do not match');
            } else {
                clearError('confirm-password');
            }
        });
    </script>
</body>
</html>